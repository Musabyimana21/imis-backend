@echo off
cls
color 0B
title ISHAKIRO IMIS - Master Control

:menu
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘                                                        â•‘
echo  â•‘         ISHAKIRO INFORMATION MANAGEMENT SYSTEM         â•‘
echo  â•‘              Lost ^& Found Platform for Rwanda          â•‘
echo  â•‘                                                        â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo  â”‚  1. START COMPLETE SYSTEM (Recommended)               â”‚
echo  â”‚  2. TEST ALL FEATURES                                 â”‚
echo  â”‚  3. STOP ALL SERVICES                                 â”‚
echo  â”‚  4. VIEW SYSTEM STATUS                                â”‚
echo  â”‚  5. OPEN FRONTEND                                     â”‚
echo  â”‚  6. OPEN API DOCS                                     â”‚
echo  â”‚  7. RESET DATABASE                                    â”‚
echo  â”‚  8. EXIT                                              â”‚
echo  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.
set /p choice="  Select option (1-8): "

if "%choice%"=="1" goto start_system
if "%choice%"=="2" goto test_system
if "%choice%"=="3" goto stop_services
if "%choice%"=="4" goto system_status
if "%choice%"=="5" goto open_frontend
if "%choice%"=="6" goto open_docs
if "%choice%"=="7" goto reset_db
if "%choice%"=="8" goto exit

echo  Invalid choice! Press any key to try again...
pause >nul
goto menu

:start_system
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘           STARTING COMPLETE SYSTEM                     â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
call START_EVERYTHING.bat
goto menu

:test_system
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘           TESTING ALL FEATURES                         â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
call TEST_ALL.bat
goto menu

:stop_services
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘           STOPPING ALL SERVICES                        â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo  Stopping backend...
taskkill /F /IM python.exe >nul 2>&1
echo  Stopping frontend...
taskkill /F /IM node.exe >nul 2>&1
echo.
echo  All services stopped!
echo.
pause
goto menu

:system_status
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘           SYSTEM STATUS                                â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo  Checking services...
echo.

REM Check PostgreSQL
sc query postgresql-x64-18 | find "RUNNING" >nul
if %errorlevel% equ 0 (
    echo  [âœ“] PostgreSQL: RUNNING
) else (
    echo  [âœ—] PostgreSQL: STOPPED
)

REM Check Backend
curl -s http://localhost:8000/health >nul 2>&1
if %errorlevel% equ 0 (
    echo  [âœ“] Backend API: RUNNING on http://localhost:8000
) else (
    echo  [âœ—] Backend API: STOPPED
)

REM Check Frontend
curl -s http://localhost:5173 >nul 2>&1
if %errorlevel% equ 0 (
    echo  [âœ“] Frontend: RUNNING on http://localhost:5173
) else (
    echo  [âœ—] Frontend: STOPPED
)

echo.
echo  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo  â”‚  Access Points:                                        â”‚
echo  â”‚  - Frontend:  http://localhost:5173                    â”‚
echo  â”‚  - Backend:   http://localhost:8000                    â”‚
echo  â”‚  - API Docs:  http://localhost:8000/docs               â”‚
echo  â”‚  - Health:    http://localhost:8000/health             â”‚
echo  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.
echo  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo  â”‚  Test Accounts:                                        â”‚
echo  â”‚  - Admin: admin@imis.rw / admin123                     â”‚
echo  â”‚  - User:  user1@imis.rw / password123                  â”‚
echo  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.
pause
goto menu

:open_frontend
start http://localhost:5173
goto menu

:open_docs
start http://localhost:8000/docs
goto menu

:reset_db
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘           RESET DATABASE                               â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo  WARNING: This will delete all data!
echo.
set /p confirm="  Are you sure? (yes/no): "
if not "%confirm%"=="yes" goto menu

echo.
echo  Resetting database...
psql -U postgres -d postgres -c "DROP DATABASE IF EXISTS imis;" >nul 2>&1
psql -U postgres -d postgres -c "CREATE DATABASE imis;" >nul 2>&1
echo  Database reset!
echo.
echo  Seeding with sample data...
cd backend
python seed_data_auto.py
cd ..
echo  Database ready!
echo.
pause
goto menu

:exit
cls
echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘           THANK YOU FOR USING ISHAKIRO!                â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo  Stopping all services...
taskkill /F /IM python.exe >nul 2>&1
taskkill /F /IM node.exe >nul 2>&1
echo.
echo  Goodbye! ðŸ‘‹
echo.
timeout /t 2 /nobreak >nul
exit
